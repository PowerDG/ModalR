@using ResearchHome.Areas.Introduction.Models
@model Members
@{
    Layout = "~/Views/Shared/_Master.cshtml";
    string photoUrl = Model != null && !string.IsNullOrEmpty(Model.Photo)  ? Model.Photo : "/images/public/NonePicture.png";
    string photoHD = Model != null && !string.IsNullOrEmpty(Model.PhotoHD) ? Model.PhotoHD : photoUrl;
    bool gender = Model != null ? Model.Gender : true;
    string actionType = ViewBag.ActionType;
}

@inject ResearchHome.Helper.ViewInjectHelper viewInjectHelper
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@section Heads{
    <link href="/css/introduce/addmember.css" rel="stylesheet" />
    <link href="/css/layerMaster.css" rel="stylesheet" />
    <style>
        .layui-form-item {
            margin-bottom: 6px;
            clear: both;
            height: 56px;
        }
    </style>
}

    <form class="layui-form layui-row-member">
        <div>
            <div class="layui-inline layui-col-addmenber">
                <div class="layui-form-item">
                    <label class="layui-form-label"><i style="color:red">*&nbsp;</i>姓名</label>
                    <div class="layui-input-block">
                        <input name="id" type="hidden" asp-for="Id" />
                        <input type="text" name="name" onchange="onchangeEvent(this,'error_name')" required lay-verify="required" asp-for="Name" placeholder="请输入姓名" autocomplete="off" class="layui-input">
                        <div id="error_name" style="display: none;">
                            <div class="valid-tips">
                                <span class="valid-tips-span field-validation-error">
                                    <span>请输入姓名</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label"><i style="color:red">*&nbsp;</i>入职时间</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input" id="entrytime" name="entrytime" onblur="onchangeEvent(this,'error_entrytime')" asp-for="EntryTime" lay-verify="required" placeholder="请选择入职时间">
                        <div id="error_entrytime" style="display: none;">
                            <div class="valid-tips">
                                <span class="valid-tips-span field-validation-error">
                                    <span>请输入选择入职时间</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label"><i style="color:red">*&nbsp;</i>生日</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input" id="birthday" name="birthday" onblur="onchangeEvent(this,'error_birthday')" asp-for="BirthDay" lay-verify="required" placeholder="请选择生日">
                        <div id="error_birthday" style="display: none;">
                            <div class="valid-tips">
                                <span class="valid-tips-span field-validation-error">
                                    <span>请选择生日</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">QQ</label>
                    <div class="layui-input-block">
                        <input type="text" placeholder="请输入QQ号" asp-for="QQ" name="qq" autocomplete="off" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label"><i style="color:red">*&nbsp;</i>登录名</label>
                    <div class="layui-input-block">
                        <input type="text" name="account" onchange="onchangeEvent(this,'error_account')" asp-for="Account" required lay-verify="required" placeholder="请输入登录名" autocomplete="off" class="layui-input">
                        <div id="error_account" style="display: none;">
                            <div class="valid-tips">
                                <span class="valid-tips-span field-validation-error">
                                    <span>请输入登录名</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">花名</label>
                    <div class="layui-input-block">
                        <input type="text" placeholder="请输入花名" asp-for="AliasName" name="aliasName" autocomplete="off" class="layui-input">
                    </div>
                </div>

            </div>

            <div class="layui-inline layui-col-addmenber">
                <div class="layui-form-item">
                    <label class="layui-form-label">性别</label>
                    <div class="layui-input-block">
                        <input type="radio" name="gender" id="rdMale" value="1" title="男" checked>
                        <input type="radio" name="gender" id="rdFemale" value="0" title="女">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label"><i style="color:red">*&nbsp;</i>职位</label>
                    <div class="layui-input-block">
                        <input type="text" name="title" onchange="onchangeEvent(this,'error_title')" asp-for="Title" required lay-verify="required" placeholder="请输入职位" autocomplete="off" class="layui-input">
                        <div id="error_title" style="display: none;">
                            <div class="valid-tips">
                                <span class="valid-tips-span field-validation-error">
                                    <span>请输入职位</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">手机号</label>
                    <div class="layui-input-block">
                        <input type="text" name="phone" asp-for="Phone" placeholder="请输入手机号" autocomplete="off" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">微信</label>
                    <div class="layui-input-block">
                        <input type="text" name="wechat" asp-for="WeChat" placeholder="请输入微信号" autocomplete="off" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">邮箱</label>
                    <div class="layui-input-block">
                        <input type="text" name="email" asp-for="Email" placeholder="请输入邮箱" autocomplete="off" class="layui-input">
                    </div>
                </div>

            </div>

            <div class="layui-inline " style="width: 23%;height: 326px;margin-left: 30px;">
                <div class="layui-upload" style="text-align: center;">
                    <div class="layui-upload-list layui-row-headimg">
                        <canvas id="myCanvas" style="display:none;"></canvas>
                        <img class="layui-upload-img layui-upload-image" title="点击预览高清图" onclick="previewPic(member.photoHD, parent.layer)" id="imgHeadPhoto" src="@photoUrl"
                             onerror="javascript: this.src = '/images/public/NonePicture.png'">
                        <input type="hidden" name="isupload" value="0" />
                        <input type="file" style="display:none" id="ImgUpload" onchange="loadUploadImg()" accept="image/jpeg,image/png,image/gif,application/msword"/>
                    </div>
                    <button type="button" class="layui-btn" onclick="$('#ImgUpload').click()">上传图片</button>
                </div>
            </div>
        </div>

        <div style="margin-bottom:20px">
            <div class="layui-form-item layui-form-text" style="height:76px;">
                <label class="layui-form-label">座右铭</label>
                <div class="layui-input-block">
                    <textarea name="motto" placeholder="请输入座右铭" rows="5" asp-for="Motto" class="layui-textarea" style="height:56px;min-height:56px;"></textarea>
                </div>
            </div>

            <div class="layui-form-item layui-form-text" style="height:76px;">
                <label class="layui-form-label">备注</label>
                <div class="layui-input-block">
                    <textarea name="remarks" placeholder="请输入备注" rows="5" asp-for="Remarks" class="layui-textarea" style="height:56px;min-height:56px;"></textarea>
                </div>
            </div>

        </div>

        <div class="layui-content-btn">
            @if (viewInjectHelper.CurrentUserInfo("IsAdmin") == "True" && actionType == "Edit")
            {
                <button type="button" class="layui-btn layui-btn-warm" onclick="resetPassword()" style="margin-top:5px;margin-right:50px;">重置密码</button>
                <div id="password" style="display:none" data-clipboard-text=""></div>
            }
            <button type="button" class="layui-btn" onclick="saveMember()" style="margin-top:5px;">保存</button>
            <button type="button" style="margin-top:5px;margin-right:10px;" class="layui-btn layui-btn-primary" onclick="parent.layer.closeAll()">取消</button>
        </div>
    </form>

@section Scripts{
    <script src="/js/global.js"></script>
    <script src="/js/introduction/Member/EditMember.js"></script>
    @*<script src="/lib/clipboard/clipboard.js"></script>*@
    <script>
        var member;
        var actipnType = '@actionType';
        var gender = '@gender';
        var photoHD = '@photoHD';
        $(document).ready(function () {
            loadPage(actipnType, photoHD, gender);
        });
    </script>
}

